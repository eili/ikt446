
insert into ikt446_adb.country_dim
select cid, cname from ikt446_odb.country;

insert into ikt446_adb.product_dim
select pid, pname from ikt446_odb.product;

insert into oilprice_dim values(10,2018,76.73);
insert into oilprice_dim values(9,2018,75.36);
insert into oilprice_dim values(8,2018,71.08);
insert into oilprice_dim values(7,2018,72.67);
insert into oilprice_dim values(6,2018,71.98);
insert into oilprice_dim values(5,2018,73.43);
insert into oilprice_dim values(4,2018,68.79);
insert into oilprice_dim values(3,2018,64.17);
insert into oilprice_dim values(2,2018,63.46);
insert into oilprice_dim values(1,2018,66.23);
insert into oilprice_dim values(12,2017,61.19);
insert into oilprice_dim values(11,2017,59.93);
insert into oilprice_dim values(10,2017,54.92);
insert into oilprice_dim values(9,2017,52.95);
insert into oilprice_dim values(8,2017,49.94);
insert into oilprice_dim values(7,2017,47.66);
insert into oilprice_dim values(6,2017,46.17);
insert into oilprice_dim values(5,2017,49.89);
insert into oilprice_dim values(4,2017,52.16);
insert into oilprice_dim values(3,2017,50.90);
insert into oilprice_dim values(2,2017,54.35);
insert into oilprice_dim values(1,2017,53.59);
insert into oilprice_dim values(12,2016,52.62);
insert into oilprice_dim values(11,2016,45.26);
insert into oilprice_dim values(10,2016,49.29);
insert into oilprice_dim values(9,2016,45.04);
insert into oilprice_dim values(8,2016,44.88);
insert into oilprice_dim values(7,2016,44.13);
insert into oilprice_dim values(6,2016,47.69);
insert into oilprice_dim values(5,2016,45.94);
insert into oilprice_dim values(4,2016,40.75);
insert into oilprice_dim values(3,2016,37.34);
insert into oilprice_dim values(2,2016,31.03);
insert into oilprice_dim values(1,2016,29.78);
insert into oilprice_dim values(12,2015,36.57);
insert into oilprice_dim values(11,2015,43.11);
insert into oilprice_dim values(10,2015,46.96);
insert into oilprice_dim values(9,2015,46.28);
insert into oilprice_dim values(8,2015,45.69);
insert into oilprice_dim values(7,2015,54.34);
insert into oilprice_dim values(6,2015,61.31);
insert into oilprice_dim values(5,2015,62.51);
insert into oilprice_dim values(4,2015,57.54);
insert into oilprice_dim values(3,2015,52.83);
insert into oilprice_dim values(2,2015,54.79);
insert into oilprice_dim values(1,2015,47.11);
insert into oilprice_dim values(12,2014,60.70);
insert into oilprice_dim values(11,2014,76.99);
insert into oilprice_dim values(10,2014,86.08);
insert into oilprice_dim values(9,2014,95.85);
insert into oilprice_dim values(8,2014,100.05);

insert into currency_dim values(1,2018,7.922);
insert into currency_dim values(2,2018,7.828);
insert into currency_dim values(3,2018,7.766);
insert into currency_dim values(4,2018,7.838);
insert into currency_dim values(5,2018,8.102);
insert into currency_dim values(6,2018,8.12);
insert into currency_dim values(7,2018,8.13);
insert into currency_dim values(8,2018,8.334);
insert into currency_dim values(9,2018,8.257);

insert into currency_dim values(1,2017,8.481);
insert into currency_dim values(2,2017,8.328);
insert into currency_dim values(3,2017,8.499);
insert into currency_dim values(4,2017,8.587);
insert into currency_dim values(5,2017,8.523);
insert into currency_dim values(6,2017,8.462);
insert into currency_dim values(7,2017,8.168);
insert into currency_dim values(8,2017,7.894);
insert into currency_dim values(9,2017,7.831);
insert into currency_dim values(10,2017,7.994);
insert into currency_dim values(11,2017,8.186);
insert into currency_dim values(12,2017,8.328);

insert into currency_dim values(1,2016,8.844);
insert into currency_dim values(2,2016,8.608);
insert into currency_dim values(3,2016,8.494);
insert into currency_dim values(4,2016,8.23);
insert into currency_dim values(5,2016,8.238);
insert into currency_dim values(6,2016,8.314);
insert into currency_dim values(7,2016,8.472);
insert into currency_dim values(8,2016,8.313);
insert into currency_dim values(9,2016,8.213);
insert into currency_dim values(10,2016,8.164);
insert into currency_dim values(11,2016,8.407);
insert into currency_dim values(12,2016,8.558);

insert into currency_dim values(1,2015,7.689);
insert into currency_dim values(2,2015,7.59);
insert into currency_dim values(3,2015,7.985);
insert into currency_dim values(4,2015,7.898);
insert into currency_dim values(5,2015,7.554);
insert into currency_dim values(6,2015,7.804);
insert into currency_dim values(7,2015,8.12);
insert into currency_dim values(8,2015,8.25);
insert into currency_dim values(9,2015,8.28);
insert into currency_dim values(10,2015,8.271);
insert into currency_dim values(11,2015,8.635);
insert into currency_dim values(12,2015,8.695);

insert into currency_dim values(1,2014,6.16);
insert into currency_dim values(2,2014,6.129);
insert into currency_dim values(3,2014,6.002);
insert into currency_dim values(4,2014,5.979);
insert into currency_dim values(5,2014,5.939);
insert into currency_dim values(6,2014,6.036);
insert into currency_dim values(7,2014,6.197);
insert into currency_dim values(8,2014,6.204);
insert into currency_dim values(9,2014,6.339);
insert into currency_dim values(10,2014,6.543);
insert into currency_dim values(11,2014,6.808);
insert into currency_dim values(12,2014,7.265);


insert into ikt446_adb.facttable
select pid, cid, month, year, amountMNOK 
from ikt446_odb.sales;

delete from fact_aggregated;
delete from facttable_USDP_Barrels;

insert into facttable_USDP_Barrels
select f.pid, f.cid, f.month, f.year, f.amountMNOK, f.amountMNOK / cdim.usdprice as amountMUSD, (1000 * f.amountMNOK) / (cdim.usdprice * odim.barrelprice) as Kbarrels
from facttable f, oilprice_dim odim, currency_dim cdim
where f.month = odim.month
and f.year = odim.year
and f.month = cdim.month
and f.year = cdim.year
and f.pid=1;

insert into fact_aggregated
select f.pid, f.cid, f.year, sum(f.amountMNOK), sum(amountMUSD), sum(kbarrels)
from facttable_USDP_Barrels f
group by f.pid, f.cid, f.year;
